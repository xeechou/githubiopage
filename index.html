<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Sichem Zhou's Blog Project</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Sichem Zhou's Blog Project </a></h1>
                <nav><ul>
                    <li><a href="/category/chinese.html">Chinese</a></li>
                    <li><a href="/category/computer-vision.html">Computer Vision</a></li>
                    <li><a href="/category/diaries.html">Diaries</a></li>
                    <li><a href="/category/programming.html">Programming</a></li>
                    <li><a href="/category/technical.html">Technical</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/template-deduction-for-c.html">Template Deduction for C++</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-11-04T00:00:00-04:00">
                Published: Fri 04 November 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/sichem-zhou.html">Sichem Zhou</a>
        </address>
<p>In <a href="/category/technical.html">Technical</a>.</p>
<p>tags: <a href="/tag/programming.html">Programming</a> <a href="/tag/cc.html">C/C++</a> </p>
</footer><!-- /.post-info --><p>Template is a confusing and hard features in C++ if you want use it well, and I
think it is also one of the reason which causes c++ programmers cannot
understand each other. Sometimes the Deduction rule for c++ is really confusing,
you don't understand why you code doesn't work or why it works. And Since
<strong>STL</strong> heavily uses nesting Templates, both your compiler and your mind suffers
from that.</p>
<h2>Function Templates</h2>
<p>People commonly start define and using templates for Container, such as
<code>std::vector</code> and <code>std::map</code>. Soon later, they want to write template functions
instead of overloading. The <code>sort</code> function from standard library is a good
example. It is usually defined as:</p>
<div class="highlight"><pre><span></span>template&lt;class RandomIt&gt; void sort(RandomIt&amp; first, RandomIt&amp; last).
</pre></div>
<p>Then you can sort a <code>vector</code> by:</p>
<div class="highlight"><pre><span></span><span class="nt">std</span><span class="o">:</span><span class="nd">:vector</span><span class="o">&lt;</span><span class="nt">float</span><span class="o">&gt;</span> <span class="nt">a</span> <span class="o">=</span> <span class="o">...;</span>
<span class="nt">std</span><span class="o">:</span><span class="nd">:sort</span><span class="o">(</span><span class="nt">a</span><span class="nc">.begin</span><span class="o">(),</span> <span class="nt">a</span><span class="nc">.end</span><span class="o">())</span>
</pre></div>
<p>The compilers try to infer the template parameters from template functions'
parameters. Sometimes compilers are not smart enough to deduce it out, then you
have to specific it yourself. The deducing mechanism is a choice of
compilers. For example, compilers never tries to deduce the type for a class
template. Compilers deduction policy is hard to implement, and quite often, I
blame for compiler's stupidity for not be able to deducing the templates(but of
course, the guys that wrote compiler usually smart than us). But for us, we need
to know when we don't need to specific the template parameters, when we will
need to. According to <a href="http://en.cppreference.com/w/cpp/language/template_argument_deduction" title="Template Deduction">CPP Reference</a>, the difference is there are some
context participate into deduction, others does not. </p>
<ul>
<li>Template deduction for template functions can be done with function arguments.</li>
<li>Compiler never deduce templates for class.</li>
<li>Template deduction cannot be done with return types.</li>
<li>Nested types such as <code>std::vector&lt;std::complex&lt;double&gt; &gt;</code> can causes troubles. </li>
<li>A template type that uses another template, like <code>F&amp; (*function)(T l, T r)</code>,
  here <code>F</code> is not deductible.</li>
<li>And there are many other rules.</li>
</ul>
<p>Looks like now, the deduction can only be done with direct type that list in code.</p>                </article>
            </aside><!-- /#featured -->
                </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 7
        <a href="/index2.html">&raquo;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://theictlab.org">theICTlab</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://ca.linkedin.com/in/sichem-zhou-4b0113b9">Linkedin</a></li>
                            <li><a href="https://github.com/xeechou">Github</a></li>
                            <li><a href="https://xeechou.blogspot.ca">YAB</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>