<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>View Matrix for projection - Sichem Zhou's Blog Project</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="/view-matrix-for-projection.html">

        <meta name="author" content="Sichem Zhou" />
        <meta name="keywords" content="Computer Vision" />
        <meta name="description" content="The MVP Matrix \(\text{Model} * \text{View} * \text{Projection}\) is the first lesson to render (the so called render is the process so that people can see it on a 2D screen )objects in Computer Graphics, which transfer a 3D object in object space into, in the end, a UV ...if (!document.getElementById(&#39;mathjaxscript_pelican_#%@#$@#&#39;)) { var align = &#34;center&#34;, indent = &#34;0em&#34;, linebreak = &#34;false&#34;; if (false) { align = (screen.width" />

        <meta property="og:site_name" content="Sichem Zhou's Blog Project" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="View Matrix for projection"/>
        <meta property="og:url" content="/view-matrix-for-projection.html"/>
        <meta property="og:description" content="The MVP Matrix \(\text{Model} * \text{View} * \text{Projection}\) is the first lesson to render (the so called render is the process so that people can see it on a 2D screen )objects in Computer Graphics, which transfer a 3D object in object space into, in the end, a UV ...if (!document.getElementById(&#39;mathjaxscript_pelican_#%@#$@#&#39;)) { var align = &#34;center&#34;, indent = &#34;0em&#34;, linebreak = &#34;false&#34;; if (false) { align = (screen.width"/>
        <meta property="article:published_time" content="2016-10-31" />
            <meta property="article:section" content="Computer Vision" />
            <meta property="article:tag" content="Computer Vision" />
            <meta property="article:author" content="Sichem Zhou" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="/theme/css/pygments/native.css" rel="stylesheet">
    <link href="/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">
Sichem Zhou's Blog Project            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li >
                            <a href="/category/chinese.html">Chinese</a>
                        </li>
                        <li class="active">
                            <a href="/category/computer-vision.html">Computer vision</a>
                        </li>
                        <li >
                            <a href="/category/diaries.html">Diaries</a>
                        </li>
                        <li >
                            <a href="/category/programming.html">Programming</a>
                        </li>
                        <li >
                            <a href="/category/technical.html">Technical</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/view-matrix-for-projection.html"
                       rel="bookmark"
                       title="Permalink to View Matrix for projection">
                        View Matrix for projection
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-10-31T00:00:00-04:00"> Mon 31 October 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="/tag/computer-vision.html">Computer Vision</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <h1>The <strong>MVP</strong> Matrix</h1>
<p><span class="math">\(\text{Model} * \text{View} * \text{Projection}\)</span> is the first lesson to render
(the so called render is the process so that people can see it on a 2D screen
)objects in Computer Graphics, which transfer a 3D object in object space into,
in the end, a UV plane.</p>
<p>The Model matrix is simple and easy to understand, simply the translation, scale
and rotation, but View matrix and Camera matrix are not obvious(although you can
get it for free by single call from <code>glm::lookAt()</code> and <code>glm::perspective()</code>).</p>
<h1>How does View Matrix work?</h1>
<p>The view matrix has another name called <code>extrinsic matrix</code> in Computer Vision,
people use it to find the where the camera is.</p>
<blockquote>
<p>The engines don't move the ship at all. The ship stays where it is and the
engines move the universe around it.</p>
</blockquote>
<p>This simply means that the view matrix does nothing but remapping everything
from $(0,0,0) to the centre of the camera. By linear algebra, it is a linear
transform that changes the basis. and one can use the <code>glm::lookAt()</code> generates
the view matrix.</p>
<p>So in the beginning, the camera sits at <span class="math">\((0,0,0)\)</span>, and looking at <span class="math">\((0,0,0)\)</span>. The
normal is <span class="math">\((0,1,0)\)</span>, since we don't know the direction, lets assume it is
<span class="math">\((0,0,-1)\)</span>. And imaging the universe is a huge Cube box that surround us.</p>
<ul>
<li>If we want to move the camera to left by <span class="math">\((-3, 0, 0)\)</span>, we can translate the cube
  by <span class="math">\((3,0,0)\)</span></li>
<li>If we want to rotate the camera to left by 30 degree, we can rotate the cube
  by 30 degree to the right.</li>
</ul>
<p>So the inefficient implementation is simply just <code>-translation * -rotation</code>,
But about the rotation part, there are simple way to do it. Called
<em>Gram-Schmidt</em> process. The essence is, again, projection, if we want to retrieve
the coordinates from one xyz coordinate system to our new coordinate system, we
can simply projecting to that system by dot product to the new axies.</p>
<p>The complete View matrix format is:
</p>
<div class="math">$$
M = 
\begin{bmatrix}
R_x &amp; R_y &amp; R_z &amp; 0 \\
U_x &amp; U_y &amp; U_z &amp; 0 \\
D_x &amp; D_y &amp; D_z &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; -T_x \\
0 &amp; 1 &amp; 0 &amp; -T_y \\
0 &amp; 0 &amp; 1 &amp; -T_z \\
0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}
$$</div>
<p><span class="math">\(R\)</span>, <span class="math">\(U\)</span>, <span class="math">\(D\)</span> is the new coordinate basis, the principle is super simple, simply
by <strong>first</strong> reverse-translate the point and <strong>second</strong> projecting on the new
coordinate system.</p>
<p>In shorter form: <span class="math">\(M = R | t\)</span>.</p>
<h1>The persepective projection</h1>
<p>Persepective projection, on the other hand, is a way to project 3d sences to 2d
plane, as the way of human eyes and camera. Which means the object further from
us looks smaller than the object closer to us.</p>
<p>It sounds nature, but how does the computer implement it? Thats where Camera
matrix were introduced.</p>
<h2>Camera matrix</h2>
<p>To finish projecting objects to our eyes, we need to follow the formula that
make futher objects smaller. Given two points ([x_1, y_1, z_1] ) and ( [x_2,
y_2, z_2 ]), they would project to the same position if ( x_1 / z_1 = x_2 /
z_2 ) and ( y_1 / z_1  = y_2 / z_2 ). The projection is to project ([x,
y, z] ) to ( [d\frac{x}{z}, d{y}{z}] ), the ( d ) there is the camera
plane.</p>
<p>Since there is now linear tranform to do that with 3d matrix, we have to use
homogeneous coordinate.
</p>
<div class="math">$$
\begin{bmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; -1/d &amp; 0
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
z\\
1\\
\end{bmatrix}=
\begin{bmatrix}
x\\
y\\
z\\
-z/d\\
\end{bmatrix}
$$</div>
<p>And as homogeneous coordinates, we should keep scale to keep last element to 1.
</p>
<div class="math">$$
\begin{bmatrix}
x\\
y\\
z\\
-z/d
\end{bmatrix} \rightarrow
\begin{bmatrix}
-d\frac{x}{z}\\
-d\frac{y}{z}\\
-d\frac{-d}\\
1
\end{bmatrix} \rightarrow
\begin{bmatrix}
-d\frac{x}{z}\\
-d\frac{y}{z}\\
\end{bmatrix}
$$</div>
<p>
We can simply replace ( 1 ) with ( -d ) in the projection matrix to reach
the same goal.</p>
<div class="math">$$
\begin{bmatrix}
-d &amp; 0 &amp; 0 &amp; 0\\
0 &amp; -d &amp; 0 &amp; 0\\
0 &amp; 0 &amp; -d &amp; 0\\
0 &amp; 0 &amp; 1  &amp; 0
\end{bmatrix}
\begin{bmatrix}
x\\
y\\
z\\
1\\
\end{bmatrix} \rightarrow
\begin{bmatrix}
-dx\\
-dy\\
-dz\\
z\\
\end{bmatrix} \rightarrow
\begin{bmatrix}
-d\frac{x}{z}\\
-d\frac{y}{z}\\
\end{bmatrix}
$$</div>
<p>Finally, the camera matrix looks like this:
</p>
<div class="math">$$
\begin{bmatrix}
-fs_x &amp;  0  &amp; x_c\\
 0    &amp;  -fs_y &amp; y_c\\
 0    &amp;  0  &amp; 1
\end{bmatrix}
$$</div>
<p>
Its little bit complex than what we have, but general idea stays the same.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </div>
            <!-- /.entry-content -->
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://ca.linkedin.com/in/sichem-zhou-4b0113b9"><i class="fa fa-linkedin-square fa-lg"></i> Linkedin</a></li>
                <li class="list-group-item"><a href="https://github.com/xeechou"><i class="fa fa-github-square fa-lg"></i> Github</a></li>
                <li class="list-group-item"><a href="https://xeechou.blogspot.ca"><i class="fa fa-yab-square fa-lg"></i> YAB</a></li>
              </ul>
            </li>





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://theictlab.org" target="_blank">
                theICTlab
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Sichem Zhou
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>


</body>
</html>